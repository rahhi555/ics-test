<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>ics作成テスト</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      h1 {
        color: #333;
        font-size: 1.5rem;
        margin-bottom: 20px;
      }
      .form-group {
        margin-bottom: 15px;
        display: none;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
      }
      input,
      textarea,
      select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
      }
      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: #007aff;
        box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
      }
      textarea {
        resize: vertical;
        min-height: 80px;
      }
      .datetime-group {
        display: flex;
        gap: 10px;
      }
      .datetime-group input {
        flex: 1;
      }
      /* button {
        width: 100%;
        padding: 15px;
        background: #007aff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        margin-top: 10px;
      }
      button:hover {
        background: #0056b3;
      }
      button:active {
        transform: scale(0.98);
      } */
      .section {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .webcal-link {
        display: block;
        text-align: center;
        margin-top: 10px;
        color: #888;
        font-size: 13px;
        text-decoration: underline;
        cursor: pointer;
      }
      .webcal-link:hover {
        color: #666;
      }
    </style>
  </head>
  <body>
    <h1>ics作成テスト</h1>

    <form action="/generate-ics" method="GET" class="section">
      <div class="form-group">
        <label for="summary">予約名</label>
        <input
          type="text"
          id="summary"
          name="summary"
          value="STITCH HOTEL Kyoto 宿泊予約"
          placeholder="宿泊施設名・予約名"
        />
      </div>

      <div class="form-group">
        <label for="dtstart">チェックイン日時</label>
        <input type="datetime-local" id="dtstart" name="dtstart" required />
      </div>

      <div class="form-group">
        <label for="dtend">チェックアウト日時</label>
        <input type="datetime-local" id="dtend" name="dtend" required />
      </div>

      <div class="form-group">
        <label for="location">宿泊施設住所</label>
        <input
          type="text"
          id="location"
          name="location"
          value="京都府京都市下京区西石垣通四条下ル斎藤町１１９"
          placeholder="宿泊施設の住所"
        />
      </div>

      <div class="form-group">
        <label for="description">予約詳細</label>
        <textarea id="description" name="description" placeholder="予約内容の詳細">
宿泊施設名: STITCH HOTEL Kyoto
プラン: スタンダードキング 【朝食付】
部屋: スタンダードキング
人数（1室目）: 大人1名 子供2名（9歳・5歳）
人数（2室目）: 大人2名 子供2名（9歳・5歳）
ベッドタイプ: キングベッド1台またはシングルベッド2台
食事: 朝食付き
含まれる特典: プール利用無料2名分（1日につき）</textarea
        >
      </div>

      <div class="form-group">
        <label for="url">予約ページURL</label>
        <input
          type="url"
          id="url"
          name="url"
          value="https://example.com/reservation/ABC12345"
          placeholder="https://..."
        />
      </div>

      <div
        style="display: flex; justify-content: center; flex-direction: column; align-items: center"
      >
        <button type="submit" style="background-color: transparent; border: none; cursor: pointer">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M19.5 3.75H4.5C4.08579 3.75 3.75 4.08579 3.75 4.5V19.5C3.75 19.9142 4.08579 20.25 4.5 20.25H19.5C19.9142 20.25 20.25 19.9142 20.25 19.5V4.5C20.25 4.08579 19.9142 3.75 19.5 3.75Z"
              stroke="#1B5CF5"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M16.5 2.25V5.25"
              stroke="#1B5CF5"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M7.5 2.25V5.25"
              stroke="#1B5CF5"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M3.75 8.25H20.25"
              stroke="#1B5CF5"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>

        カレンダー追加
      </div>

      <!-- <a class="webcal-link" onclick="openWebcal()">webcal方式で登録</a> -->
    </form>

    <script>
      // 日時をYYYY-MM-DDTHH:MM形式にフォーマット
      function formatDateTime(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, "0");
        const day = String(date.getDate()).padStart(2, "0");
        const hours = String(date.getHours()).padStart(2, "0");
        const minutes = String(date.getMinutes()).padStart(2, "0");
        return `${year}-${month}-${day}T${hours}:${minutes}`;
      }

      // 初期日時を設定
      const today = new Date();

      // チェックイン: 明日 15:00
      const checkin = new Date(today);
      checkin.setDate(today.getDate() + 1);
      checkin.setHours(15, 0, 0, 0);
      document.getElementById("dtstart").value = formatDateTime(checkin);

      // チェックアウト: 明日から4日後 11:00
      const checkout = new Date(checkin);
      checkout.setDate(checkin.getDate() + 4);
      checkout.setHours(11, 0, 0, 0);
      document.getElementById("dtend").value = formatDateTime(checkout);

      // function openWebcal() {
      //   const summary = document.getElementById("summary").value;
      //   const dtstart = document.getElementById("dtstart").value;
      //   const dtend = document.getElementById("dtend").value;
      //   const location = document.getElementById("location").value;
      //   const description = document.getElementById("description").value;
      //   const url = document.getElementById("url").value;

      //   if (!dtstart || !dtend) {
      //     alert("チェックイン日とチェックアウト日を入力してください");
      //     return;
      //   }

      //   const params = new URLSearchParams({
      //     summary,
      //     dtstart,
      //     dtend,
      //     location,
      //     description,
      //     url,
      //   });

      //   // 現在のURLからwebcal://スキームのURLを生成
      //   const currentUrl = new URL(window.location.href);
      //   const webcalUrl = `webcal://${currentUrl.host}/generate-ics?${params.toString()}`;

      //   window.location.href = webcalUrl;
      // }
    </script>
  </body>
</html>
