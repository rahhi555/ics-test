<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>ics作成テスト</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      h1 {
        color: #333;
        font-size: 1.5rem;
        margin-bottom: 20px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #555;
      }
      input,
      textarea,
      select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
      }
      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: #007aff;
        box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
      }
      textarea {
        resize: vertical;
        min-height: 80px;
      }
      .datetime-group {
        display: flex;
        gap: 10px;
      }
      .datetime-group input {
        flex: 1;
      }
      button {
        width: 100%;
        padding: 15px;
        background: #007aff;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        margin-top: 10px;
      }
      button:hover {
        background: #0056b3;
      }
      button:active {
        transform: scale(0.98);
      }
      .section {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .webcal-link {
        display: block;
        text-align: center;
        margin-top: 10px;
        color: #888;
        font-size: 13px;
        text-decoration: underline;
        cursor: pointer;
      }
      .webcal-link:hover {
        color: #666;
      }
    </style>
  </head>
  <body>
    <h1>ics作成テスト</h1>

    <form action="/generate-ics" method="GET" class="section">
      <div class="form-group">
        <label for="summary">予約名</label>
        <input
          type="text"
          id="summary"
          name="summary"
          value="温泉旅館 山水荘 宿泊予約"
          placeholder="宿泊施設名・予約名"
        />
      </div>

      <div class="form-group">
        <label for="dtstart">チェックイン日</label>
        <input type="date" id="dtstart" name="dtstart" required />
      </div>

      <div class="form-group">
        <label for="dtend">チェックアウト日</label>
        <input type="date" id="dtend" name="dtend" required />
      </div>

      <div class="form-group">
        <label for="location">宿泊施設住所</label>
        <input
          type="text"
          id="location"
          name="location"
          value="東京都渋谷区神宮前1-2-3"
          placeholder="宿泊施設の住所"
        />
      </div>

      <div class="form-group">
        <label for="description">予約詳細</label>
        <textarea id="description" name="description" placeholder="予約内容の詳細">
予約番号: ABC12345
プラン: 3泊4日 スタンダードプラン
部屋タイプ: 和室10畳
人数: 大人2名
備考: 禁煙室希望</textarea
        >
      </div>

      <div class="form-group">
        <label for="url">予約ページURL</label>
        <input
          type="url"
          id="url"
          name="url"
          value="https://example.com/reservation/ABC12345"
          placeholder="https://..."
        />
      </div>

      <button type="submit">ICSファイルをダウンロード</button>

      <!-- <a class="webcal-link" onclick="openWebcal()">webcal方式で登録</a> -->
    </form>

    <script>
      // 日付をYYYY-MM-DD形式にフォーマット
      function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, "0");
        const day = String(date.getDate()).padStart(2, "0");
        return `${year}-${month}-${day}`;
      }

      // 初期日付を設定
      const today = new Date();

      // チェックイン: 明日
      const tomorrow = new Date(today);
      tomorrow.setDate(today.getDate() + 1);
      document.getElementById("dtstart").value = formatDate(tomorrow);

      // チェックアウト: 明日から4日後
      const checkout = new Date(tomorrow);
      checkout.setDate(tomorrow.getDate() + 4);
      document.getElementById("dtend").value = formatDate(checkout);

      // function openWebcal() {
      //   const summary = document.getElementById("summary").value;
      //   const dtstart = document.getElementById("dtstart").value;
      //   const dtend = document.getElementById("dtend").value;
      //   const location = document.getElementById("location").value;
      //   const description = document.getElementById("description").value;
      //   const url = document.getElementById("url").value;

      //   if (!dtstart || !dtend) {
      //     alert("チェックイン日とチェックアウト日を入力してください");
      //     return;
      //   }

      //   const params = new URLSearchParams({
      //     summary,
      //     dtstart,
      //     dtend,
      //     location,
      //     description,
      //     url,
      //   });

      //   // 現在のURLからwebcal://スキームのURLを生成
      //   const currentUrl = new URL(window.location.href);
      //   const webcalUrl = `webcal://${currentUrl.host}/generate-ics?${params.toString()}`;

      //   window.location.href = webcalUrl;
      // }
    </script>
  </body>
</html>
